[hr]
[size=18][b][align=center]*** QEMU user interface console ***[/align][/b][/size]
[hr]
[img=right]https://libdepo.github.io/images/quic0.png[/img]
[br]
[color=blue][b]Назначение проекта: [/b][/color][list]Запуск эмулятора [b]QEMU[/b] через пользовательское меню «Far Manager» или «Проводник» Windows.[/list]
[br]
[color=blue][b]Представляет собой: [/b][/color][list]Командный бат-файл.[/list]
[br]
[color=blue][b]Требования: [/b][/color][list]
[*]рабочая среда: Windows 7-10;
[*]права "Администратора".
[/list]
[br]
[color=blue][b]Поддерживает загрузку: [/b][/color][list]
[*]образы дискет, HDD, CD/DVD (в том числе, нестандартного формата и/или сжатые GZ), загрузочные WIM-образы Windows;
[*]с флешки, физического HDD или CD/DVD;
[*]с эмуляцией TFTP-загрузки;
[/list]
[br]
[spoiler=Readme.txt][pre]
				*** QEMU user interface console (QUIC) ***

 Предназначен для запуска эмулятора QEMU через пользовательское меню Far Manager.

 Требования:
- рабочая среда: Windows 7-10;
- права "Администратора".

 Папка "qemu" должна содержать дистрибутив нужной версии QEMU (в комплекте идёт QEMU 5.1.0 x64).

=========================================================================================================

Настройка ПК.
~~~~~~~~~~~~
Меню пользователя (F2) Far Manager:

Q:   QEMU user interface console
     C:\QUIC\zrun.cmd "!\!.!"

Примечание:
- предполагается, что QUIC находится в папке "C:\QUIC". В противном случае укажите нужное расположение.

 Для использования через стандартный "Проводник" (Win+E), создать CMD-файл:

"%USERPROFILE%\SendTo\QEMU user interface console.cmd"

=== CMD-файл: начало ===

C:\QUIC\zrun.cmd "%~1"

=== CMD-файл: конец  ===

Использование:
- нажать ПКМ на нужном файле образа или папке (см. "Как загрузить");
- выбрать "Отправить";
- выбрать "QEMU user interface console".

=========================================================================================================

Как загрузить:
~~~~~~~~~~~~~
1. Образ стандартной дискеты (1.44 Мб, 2.88 Мб):
 Встать в Far Manager на файл с расширением (ima, img) и через меню вызывать QUIC.

2. Образ CD/DVD:
 Как в п.1, но файл с расширением (iso).

3. Образ HDD:
 Как в п.1, но файл с расширением (hdd, vdi, vhd, vmdk).

4. Образ сжатой и/или нестандартной дискеты, HDD, CD/DVD или загрузочный образ WIM:
 Как в п.1, но файл с расширением (gz, wim).

5. Как загрузиться с флешки, физического HDD или CD/DVD:
 В Far Manager выбрать диск, с которого нужно загрузиться, встать на любую папку или файл
 (с расширением отличным от перечисленных в пп.1-4) и через меню вызывать QUIC.

6. Как эмулировать загрузку по TFTP:
 В Far Manager встать на файл, который является загрузчиком, через меню вызвать QUIC и нажатием
 клавиши Tab выбрать тип загрузки "TFTP network loader".

Примечания:
- нажатием клавиши Tab можно сменить тип загрузки, если автоматически он определён неверно;
- не забывайте правильно выбирать тип Firmware (BIOS/UEFI);
- чипсет Q35 + ICH9 более предпочтителен, используйте i440FX + PIIX только для эмуляции старых систем;
- если нужно проверить работоспособность на CPU без поддержки х64, выберите тип CPU "qemu32";

Режим Firmware: UEFI x64 Secure Boot.
 В этом режиме необходимо вручную выбирать загрузочное устройство:
- дождитесь появления внизу экрана надписи "Start boot options";
- нажмите Esc;
- выберите пункт меню "Boot Manager";
- выберите из списка устройств необходимое для загрузки.

=========================================================================================================

Управление.
~~~~~~~~~~
Enter:		запуск QEMU.
Ctrl+Q:		выход.
Ctrl+A:		управление аппаратным ускорением.
Tab:		смена типа загрузки.
Space:		управление дополнительными носителями.
BackSpace (BS): запустить предыдущую сессию QEMU.

Цифровые клавиши:
1-4,7,8:	нажатие на клавишу приводит к циклической смене возможных значений параметра.
5:		ввести значение выделяемой памяти.
6:		выводит список возможных значений параметра CPU и ждёт ввода номера (нажатие
		пустого Enter означает выбор по умолчанию).

Типы загрузки:
- Floppy drive image:	загрузка образов дискет (без сжатия); файлы с расширением: ima, img
- Virtual drive image:	загрузка образов жёстких дисков; файлы с расширением: hdd, vdi, vhd, vmdk
- CD/DVD drive image:	загрузка образов CD\DVD; файлы с расширением: iso
- Hard drive:		загрузка с физического диска (\\.\PhysicalDrive);
			если диск недоступен из diskpart, считается, что это CD/DVD drive.
- Grub4Dos PXE mode:	загрузка нестандартных и\или сжатых (GZ) образов дискет, жёстких дисков и CD\DVD;
			загрузка WIM-ядер Windows; файлы с расширением: gz, wim
- TFTP network loader:	загрузка по протоколу TFTP.

Типы Firmware:	BIOS, BIOS [256k], UEFI x64, UEFI x64 Secure Boot.

Типы Accel (аппаратное ускорение): off, HAXM, Hyper-V.

Типы Video:
- Standard VGA;
- Standard VGA 32 Mb video memory;
- Standard VGA 64 Mb video memory;
- Cirrus Logic;
- ISA-VGA.

Типы чипсета:	i440FX + PIIX, Q35 + ICH9.

Доп.параметры (Misc):
-no-acpi	- выключить ACPI;
-no-hpet	- выключить High Precision Event Timer;
manual		- ввести вручную дополнительные параметры перед запуском QEMU.

Физический доступ к носителям и образам (readonly):
- Yes (только-чтение, по умолчанию);
- No  (запись-чтение, не рекомендуется!).


Управление дополнительными носителями.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
В качестве носителя могут выступать: файл, физический диск, папка.

1. Добавить файл:
   - выбрать файл;
   - выбрать точку подключения:
     1   - если выбранный файл является образом дискеты;
     2,4 - если выбранный файл является образом жёсткого диска;
     3,5 - если выбранный файл является образом CD/DVD.

2. Добавить папку/диск:
   - выбрать папку или диск;
   - выбрать точку подключения (2,4).

3. Создать файл образа диска (VHD):
   - выбрать папку, где будет создан файл;
   - ввести имя (по умолчанию "image.vhd") и размер в Мб;
   - выбрать пустой (1) или с начальной разметкой (2,3);
   - выбрать точку подключения (2,4).

7-9:		отключение ранее подключенных носителей.
Enter, Space:	возврат в основное меню.

Примечание:
- нажатие пустого Enter при запросе точки подключения прерывает подключение.


Управление окном QEMU.
~~~~~~~~~~~~~~~~~~~~~
Alt+M:		меню "Machine".
Alt+V:		меню "View".
Ctrl+Alt+F:	переключение в "полный экран".
Ctrl+Alt+2:	консоль.
Ctrl+Alt+1:	возврат в окно выполнения.

=========================================================================================================

Управление аппаратным ускорением.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Ctrl+H:		установить ускоритель HAXM.
Ctrl+V:		установить ускоритель Hyper-V (включить компоненты в системе).
Ctrl+F:		временно отключить ускорение Hyper-V.
Ctrl+N:		включить (ранее отключённое) ускорение Hyper-V.

Примечания:
- ускорение HAXM доступно на ПК под управлением ОС Windows 7-10 x64;
- ускорение Hyper-V доступно на ПК под управлением ОС Windows 10 х64 ver. 1803 и выше;
- одновременная работа ускорителей невозможна;
- ускоритель HAXM можно установить вручную (папка "haxm" содержит дистрибутив для установки);
- установка, вкл./выкл. ускорения Hyper-V требует перезагрузки;
- аппаратное ускорение несовместимо с режимом UEFI x64 Secure Boot.

=========================================================================================================

Ссылки.
~~~~~~
Сайт Far Manager:
https://farmanager.com/

Сборки QEMU:
https://qemu.weilnetz.de/

Альтернативные сборки QEMU:
http://www.omledom.com/

Образы OMVF (без Secure Boot):
https://www.kraxel.org/repos/jenkins/edk2/

Образы OMVF (Secure Boot):
http://ftp.br.debian.org/debian/pool/main/e/edk2/ovmf_2020.11-2_all.deb

Ускоритель HAXM:
https://github.com/intel/haxm/

Статья Microsoft как включить на ПК поддержку Hyper-V:
https://docs.microsoft.com/en-us/xamarin/android/get-started/installation/android-emulator/hardware-acceleration/

________________
© Ander_73, 2021
[/pre][/spoiler]
[spoiler=Screenshots][align=center]
[th]https://libdepo.github.io/images/quic1.png[/th]
[th]https://libdepo.github.io/images/quic2.png[/th]
[th]https://libdepo.github.io/images/quic3.gif[/th]
[th]https://libdepo.github.io/images/quic4.png[/th]
[/align][/spoiler]
[spoiler=Известные проблемы][list]
[*]при использовании ускорителя HAXM есть проблемы с загрузкой некоторых образов Windows;
[*]при использовании загрузки «Grub4Dos PXE mode» загружаемый образ должен находится на одном разделе HDD с QUIC.
[/list][/spoiler]
[align=center][url=https://libdepo.github.io/files/qemu.7z]Загрузить QUIC [img]https://libdepo.github.io/images/download.png[/img][/url][/align]